# P0 Feature Test Definitions
# CRITICAL: These tests must NEVER be skipped and MUST pass before any commit
# Enforces user requirement: "ensure that all P0 features are always tested moving forward and never skipped"
# Note: User name is configurable via .claudedirector/config/user_identity.yaml

version: "1.0"
enforcement_policy: "ZERO_TOLERANCE"
blocking_failures_allowed: 0

p0_features:
  # BLOCKING LEVEL: Must pass or commit is blocked
  - name: "MCP Transparency P0"
    test_module: ".claudedirector/tests/regression/test_mcp_transparency_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "MCP server transparency disclosure must work reliably"
    failure_impact: "Strategic persona responses lose critical transparency"
    business_impact: "Users cannot see AI enhancement usage - transparency broken"
    introduced_version: "v2.1.0"
    owner: "martin"

  - name: "Conversation Tracking P0"
    test_module: ".claudedirector/tests/conversation/test_conversation_tracking_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Strategic memory conversation capture must work"
    failure_impact: "Strategic context preservation fails across sessions"
    business_impact: "Strategic intelligence loses conversation continuity"
    introduced_version: "v2.2.0"
    owner: "martin"

  - name: "Conversation Quality P0"
    test_module: ".claudedirector/tests/conversation/test_p0_quality_target.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Conversation quality must exceed 0.7 threshold"
    failure_impact: "Strategic intelligence data quality degrades critically"
    business_impact: "Executive strategic guidance becomes unreliable"
    introduced_version: "v2.2.0"
    owner: "martin"

  # HIGH PRIORITY: Should pass but won't block commit
  - name: "First-Run Wizard P0"
    test_module: ".claudedirector/tests/integration/test_first_run_wizard_comprehensive.py"
    critical_level: "HIGH"
    timeout_seconds: 60
    description: "Complete first-run wizard user journey must work end-to-end"
    failure_impact: "New users cannot onboard or customize system properly"
    business_impact: "User abandonment on first use - critical onboarding failure"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "Cursor Integration P0"
    test_module: ".claudedirector/tests/integration/test_cursor_integration_comprehensive.py"
    critical_level: "HIGH"
    timeout_seconds: 60
    description: "Cursor environment integration must work"
    failure_impact: "Core usage environment fails for primary users"
    business_impact: "Primary user environment broken"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "MCP Integration P0"
    test_module: ".claudedirector/tests/integration/test_cursor_integration.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "MCP server integration and enhancement system must work"
    failure_impact: "Strategic personas lose MCP enhancement capabilities"
    business_impact: "AI strategic intelligence severely degraded without MCP"
    introduced_version: "v2.0.0"
    owner: "martin"

  - name: "Persona Strategic Thinking P0"
    test_module: ".claudedirector/tests/persona/test_persona_personalities.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Persona strategic thinking and pushback capabilities must work"
    failure_impact: "Personas lose ability to challenge assumptions and provide strategic pushback"
    business_impact: "Strategic guidance becomes passive and loses critical thinking value"
    introduced_version: "v2.0.0"
    owner: "rachel"

  - name: "CLI Functionality P0"
    test_module: ".claudedirector/tests/regression/user_journeys/test_cli_functionality.py"
    critical_level: "HIGH"
    timeout_seconds: 90
    description: "Command-line interface functionality must work for daily user workflows"
    failure_impact: "Users lose access to core ClaudeDirector functionality via CLI"
    business_impact: "Daily user workflows broken - CLI unusable for core tasks"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "Memory Context Persistence P0"
    test_module: ".claudedirector/tests/regression/user_journeys/memory_context/"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Memory and context persistence must work for strategic continuity (modular tests)"
    failure_impact: "Strategic context lost, relationships reset, initiative tracking broken"
    business_impact: "Strategic continuity destroyed - context and memory unusable"
    introduced_version: "v1.0.0"
    owner: "alvaro"
    modules: ["test_user_configuration.py", "test_strategic_context.py", "test_stakeholder_intelligence.py", "test_memory_performance.py"]

  - name: "Framework Attribution System P0"
    test_module: ".claudedirector/tests/regression/user_journeys/framework_attribution/"
    critical_level: "HIGH"
    timeout_seconds: 90
    description: "Framework detection and attribution must work for strategic intelligence (modular tests)"
    failure_impact: "Strategic frameworks not detected, attribution missing, intelligence degraded"
    business_impact: "Strategic guidance becomes generic - framework intelligence unusable"
    introduced_version: "v1.0.0"
    owner: "rachel"
    modules: ["test_framework_detection.py", "test_framework_attribution.py", "test_framework_coordination.py", "test_framework_recommendations.py"]

  # ALVARO'S BUSINESS-CRITICAL TESTS
  - name: "Configuration Persistence P0"
    test_module: ".claudedirector/tests/regression/business_critical/test_configuration_persistence.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "User configuration and customization data must persist across sessions"
    failure_impact: "User settings lost, re-onboarding required, personalization destroyed"
    business_impact: "User frustration, productivity loss, tool abandonment"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  - name: "ROI Tracking P0"
    test_module: ".claudedirector/tests/regression/business_critical/test_roi_tracking.py"
    critical_level: "BLOCKING"
    timeout_seconds: 180
    description: "ROI calculation and investment tracking must work for strategic decisions"
    failure_impact: "Investment decisions compromised, ROI visibility lost, budget misallocation"
    business_impact: "Poor investment decisions, inability to demonstrate platform value"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  - name: "Performance P0"
    test_module: ".claudedirector/tests/regression/business_critical/test_performance.py"
    critical_level: "HIGH"
    timeout_seconds: 300
    description: "System performance must meet executive requirements under realistic load"
    failure_impact: "Poor user experience, executive frustration, system abandonment"
    business_impact: "Reduced usage, poor executive experience, strategic tool abandonment"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  - name: "Security P0"
    test_module: ".claudedirector/tests/regression/business_critical/test_security.py"
    critical_level: "BLOCKING"
    timeout_seconds: 240
    description: "Security controls must protect sensitive strategic data and stakeholder intelligence"
    failure_impact: "Data breaches, unauthorized access, competitive intelligence loss"
    business_impact: "Regulatory fines, competitive disadvantage, trust loss, compliance violations"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  # RACHEL'S UX CONTINUITY TESTS
  - name: "Persona Consistency P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_persona_consistency.py"
    critical_level: "HIGH"
    timeout_seconds: 180
    description: "Persona behavior and communication must remain consistent across all interactions"
    failure_impact: "User confusion, reduced trust, unpredictable persona behavior"
    business_impact: "User abandonment, reduced engagement, persona switching abandonment"
    introduced_version: "v2.3.0"
    owner: "rachel"

  - name: "Context Switching P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_context_switching.py"
    critical_level: "HIGH"
    timeout_seconds: 200
    description: "Context transitions must be smooth and maintain conversation continuity"
    failure_impact: "Jarring transitions, lost context, conversation abandonment"
    business_impact: "Cognitive overload, reduced productivity, poor user experience"
    introduced_version: "v2.3.0"
    owner: "rachel"

  - name: "Error Recovery P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_error_recovery.py"
    critical_level: "BLOCKING"
    timeout_seconds: 150
    description: "Error handling must be graceful and preserve user trust and context"
    failure_impact: "Poor error experience, lost user trust, context destruction"
    business_impact: "User frustration, system abandonment, support overhead"
    introduced_version: "v2.3.0"
    owner: "rachel"

  - name: "Cross-Environment Consistency P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_cross_environment.py"
    critical_level: "HIGH"
    timeout_seconds: 220
    description: "Experience must be consistent across Cursor, Claude Chat, and CLI environments"
    failure_impact: "Fragmented experience, platform confusion, reduced adoption"
    business_impact: "Platform preference bias, training overhead, user inefficiency"
    introduced_version: "v2.3.0"
    owner: "rachel"

  # PHASE 1 AI INTELLIGENCE - CRITICAL BUSINESS FEATURE
  - name: "AI Intelligence P0"
    test_module: ".claudedirector/tests/regression/business_critical/test_ai_intelligence_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Advanced AI Intelligence system must provide 90%+ decision detection accuracy and <500ms latency"
    failure_impact: "Strategic decision intelligence fails, MCP coordination broken, framework detection degraded"
    business_impact: "Strategic guidance becomes unreliable, executive decision support compromised, competitive disadvantage"
    introduced_version: "v3.0.0"
    owner: "martin"



# Enforcement settings
enforcement:
  run_on_commit: true
  run_on_push: true
  run_on_pr: true
  save_results: true
  generate_reports: true
  audit_trail: true

# Notification settings
notifications:
  on_failure: true
  on_success: false
  include_business_impact: true
  include_remediation_steps: true

# Quality gates
quality_gates:
  minimum_pass_rate: 1.0  # 100% for BLOCKING tests
  maximum_duration_seconds: 300  # 5 minutes total
  retry_failed_tests: false  # No retries - immediate feedback
  fail_fast: true  # Stop on first BLOCKING failure

# Reporting
reporting:
  include_duration: true
  include_coverage: false
  include_performance: true
  save_to_file: true
  format: "json"
  retention_days: 30
