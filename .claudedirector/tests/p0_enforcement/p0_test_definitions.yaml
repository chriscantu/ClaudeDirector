# P0 Feature Test Definitions
# CRITICAL: These tests must NEVER be skipped and MUST pass before any commit
# Enforces user requirement: "ensure that all P0 features are always tested moving forward and never skipped"
# Note: User name is configurable via .claudedirector/config/user_identity.yaml

version: "1.0"
enforcement_policy: "ZERO_TOLERANCE"
blocking_failures_allowed: 0

p0_features:
  # BLOCKING LEVEL: Must pass or commit is blocked
  - name: "MCP Transparency P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_mcp_transparency.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "MCP server transparency disclosure must work reliably"
    failure_impact: "Strategic persona responses lose critical transparency"
    business_impact: "Users cannot see AI enhancement usage - transparency broken"
    introduced_version: "v2.1.0"
    owner: "martin"

  - name: "Conversation Tracking P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_conversation_tracking.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Strategic memory conversation capture must work"
    failure_impact: "Strategic context preservation fails across sessions"
    business_impact: "Strategic intelligence loses conversation continuity"
    introduced_version: "v2.2.0"
    owner: "martin"

  - name: "Conversation Quality P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_conversation_quality.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Conversation quality must exceed 0.7 threshold"
    failure_impact: "Strategic intelligence data quality degrades critically"
    business_impact: "Executive strategic guidance becomes unreliable"
    introduced_version: "v2.2.0"
    owner: "martin"

  # HIGH PRIORITY: Should pass but won't block commit
  - name: "First-Run Wizard P0"
    test_module: ".claudedirector/tests/regression/p0_high_priority/test_first_run_wizard.py"
    critical_level: "HIGH"
    timeout_seconds: 60
    description: "Complete first-run wizard user journey must work end-to-end"
    failure_impact: "New users cannot onboard or customize system properly"
    business_impact: "User abandonment on first use - critical onboarding failure"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "Cursor Integration P0"
    test_module: ".claudedirector/tests/regression/p0_high_priority/test_cursor_integration.py"
    critical_level: "HIGH"
    timeout_seconds: 60
    description: "Cursor environment integration must work"
    failure_impact: "Core usage environment fails for primary users"
    business_impact: "Primary user environment broken"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "MCP Integration P0"
    test_module: ".claudedirector/tests/integration/test_cursor_integration.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "MCP server integration and enhancement system must work"
    failure_impact: "Strategic personas lose MCP enhancement capabilities"
    business_impact: "AI strategic intelligence severely degraded without MCP"
    introduced_version: "v2.0.0"
    owner: "martin"

  - name: "Persona Strategic Thinking P0"
    test_module: ".claudedirector/tests/persona/test_persona_personalities.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Persona strategic thinking and pushback capabilities must work"
    failure_impact: "Personas lose ability to challenge assumptions and provide strategic pushback"
    business_impact: "Strategic guidance becomes passive and loses critical thinking value"
    introduced_version: "v2.0.0"
    owner: "rachel"

  - name: "CLI Functionality P0"
    test_module: ".claudedirector/tests/regression/p0_high_priority/test_cli_functionality.py"
    critical_level: "HIGH"
    timeout_seconds: 90
    description: "Command-line interface functionality must work for daily user workflows"
    failure_impact: "Users lose access to core ClaudeDirector functionality via CLI"
    business_impact: "Daily user workflows broken - CLI unusable for core tasks"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "Memory Context Persistence P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/memory_context_modules/"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Memory and context persistence must work for strategic continuity (modular tests)"
    failure_impact: "Strategic context lost, relationships reset, initiative tracking broken"
    business_impact: "Strategic continuity destroyed - context and memory unusable"
    introduced_version: "v1.0.0"
    owner: "alvaro"
    modules: ["test_user_configuration.py", "test_strategic_context.py", "test_stakeholder_intelligence.py", "test_memory_performance.py"]

  - name: "Framework Attribution System P0"
    test_module: ".claudedirector/tests/regression/user_journeys/framework_attribution/"
    critical_level: "HIGH"
    timeout_seconds: 90
    description: "Framework detection and attribution must work for strategic intelligence (modular tests)"
    failure_impact: "Strategic frameworks not detected, attribution missing, intelligence degraded"
    business_impact: "Strategic guidance becomes generic - framework intelligence unusable"
    introduced_version: "v1.0.0"
    owner: "rachel"
    modules: ["test_framework_detection.py", "test_framework_attribution.py", "test_framework_coordination.py", "test_framework_recommendations.py"]

  # PHASE 12: ALWAYS-ON MCP ENHANCEMENT P0 TESTS
  - name: "Always-On MCP Enhancement P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_phase12_always_on_mcp.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Phase 12 always-on MCP enhancement must work with 100% enhancement rate"
    failure_impact: "MCP enhancement rate drops below 100%, users lose guaranteed AI enhancement"
    business_impact: "Strategic guidance becomes inconsistent - Phase 12 value proposition broken"
    introduced_version: "v3.5.0"
    owner: "martin"

  - name: "Lightweight Fallback Pattern P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_lightweight_fallback.py"
    critical_level: "BLOCKING"
    timeout_seconds: 90
    description: "OVERVIEW.md lightweight fallback pattern must provide graceful degradation"
    failure_impact: "System fails when MCP servers unavailable, no fallback functionality"
    business_impact: "Strategic guidance becomes unavailable during server maintenance"
    introduced_version: "v3.5.0"
    owner: "martin"

  - name: "Magic MCP Visual Integration P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_magic_mcp_visual.py"
    critical_level: "HIGH"
    timeout_seconds: 120
    description: "Phase 12 Magic MCP visual detection and routing must work automatically"
    failure_impact: "Visual requests not routed to Magic MCP, users lose automatic visual enhancement"
    business_impact: "Strategic visuals become manual, reduced user experience for diagrams/charts"
    introduced_version: "v3.5.0"
    owner: "rachel"

  # ALVARO'S BUSINESS-CRITICAL TESTS
  - name: "Configuration Persistence P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_configuration_persistence.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "User configuration and customization data must persist across sessions"
    failure_impact: "User settings lost, re-onboarding required, personalization destroyed"
    business_impact: "User frustration, productivity loss, tool abandonment"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  - name: "ROI Tracking P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_roi_tracking.py"
    critical_level: "BLOCKING"
    timeout_seconds: 180
    description: "ROI calculation and investment tracking must work for strategic decisions"
    failure_impact: "Investment decisions compromised, ROI visibility lost, budget misallocation"
    business_impact: "Poor investment decisions, inability to demonstrate platform value"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  - name: "Performance P0"
    test_module: ".claudedirector/tests/regression/business_critical/test_performance.py"
    critical_level: "HIGH"
    timeout_seconds: 300
    description: "System performance must meet executive requirements under realistic load"
    failure_impact: "Poor user experience, executive frustration, system abandonment"
    business_impact: "Reduced usage, poor executive experience, strategic tool abandonment"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  - name: "Security P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_security.py"
    critical_level: "BLOCKING"
    timeout_seconds: 240
    description: "Security controls must protect sensitive strategic data and stakeholder intelligence"
    failure_impact: "Data breaches, unauthorized access, competitive intelligence loss"
    business_impact: "Regulatory fines, competitive disadvantage, trust loss, compliance violations"
    introduced_version: "v2.3.0"
    owner: "alvaro"

  # RACHEL'S UX CONTINUITY TESTS
  - name: "Persona Consistency P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_persona_consistency.py"
    critical_level: "HIGH"
    timeout_seconds: 180
    description: "Persona behavior and communication must remain consistent across all interactions"
    failure_impact: "User confusion, reduced trust, unpredictable persona behavior"
    business_impact: "User abandonment, reduced engagement, persona switching abandonment"
    introduced_version: "v2.3.0"
    owner: "rachel"

  - name: "Context Switching P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_context_switching.py"
    critical_level: "HIGH"
    timeout_seconds: 200
    description: "Context transitions must be smooth and maintain conversation continuity"
    failure_impact: "Jarring transitions, lost context, conversation abandonment"
    business_impact: "Cognitive overload, reduced productivity, poor user experience"
    introduced_version: "v2.3.0"
    owner: "rachel"

  - name: "Error Recovery P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_error_recovery.py"
    critical_level: "BLOCKING"
    timeout_seconds: 150
    description: "Error handling must be graceful and preserve user trust and context"
    failure_impact: "Poor error experience, lost user trust, context destruction"
    business_impact: "User frustration, system abandonment, support overhead"
    introduced_version: "v2.3.0"
    owner: "rachel"

  - name: "Cross-Environment Consistency P0"
    test_module: ".claudedirector/tests/regression/ux_continuity/test_cross_environment.py"
    critical_level: "HIGH"
    timeout_seconds: 220
    description: "Experience must be consistent across Cursor, Claude Chat, and CLI environments"
    failure_impact: "Fragmented experience, platform confusion, reduced adoption"
    business_impact: "Platform preference bias, training overhead, user inefficiency"
    introduced_version: "v2.3.0"
    owner: "rachel"

  # PHASE 1 AI INTELLIGENCE - CRITICAL BUSINESS FEATURE
  - name: "AI Intelligence P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_ai_intelligence.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Advanced AI Intelligence system must provide 90%+ decision detection accuracy and <500ms latency"
    failure_impact: "Strategic decision intelligence fails, MCP coordination broken, framework detection degraded"
    business_impact: "Strategic guidance becomes unreliable, executive decision support compromised, competitive disadvantage"
    introduced_version: "v3.0.0"
    owner: "martin"

  # PHASE 2 AI INTELLIGENCE - ENHANCED FRAMEWORK DETECTION
  - name: "Enhanced Framework Detection P0"
    test_module: ".claudedirector/tests/unit/ai_intelligence/test_enhanced_framework_detection.py"
    critical_level: "HIGH"
    timeout_seconds: 180
    description: "Enhanced Framework Detection must provide 95%+ relevance with proactive suggestions and <200ms latency"
    failure_impact: "Proactive framework suggestions fail, context analysis degraded, business impact scoring broken"
    business_impact: "Strategic framework recommendations become reactive, reduced strategic guidance quality, missed optimization opportunities"
    introduced_version: "v3.1.0"
    owner: "martin"

  # MARTIN'S PLATFORM ARCHITECTURE - SETUP FEATURE P0
  - name: "Setup Feature P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_setup_feature.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Setup feature must work reliably for new user onboarding and system initialization (includes regression protection)"
    failure_impact: "New users cannot install or configure ClaudeDirector, setup process fails"
    business_impact: "User abandonment, failed onboarding, system unusable for new users"
    introduced_version: "v1.0.0"
    owner: "martin"

  - name: "Workspace Integration P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_workspace_integration.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Context Engineering Phase 2.1 workspace integration must work reliably for strategic document monitoring and context persistence"
    failure_impact: "Strategic workspace context unavailable, cross-session persistence broken, document monitoring fails"
    business_impact: "Strategic intelligence loses workspace awareness, context persistence broken across Cursor sessions"
    introduced_version: "v2.3.0"
    owner: "martin"

  - name: "Analytics Engine P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_analytics_engine.py"
    critical_level: "BLOCKING"
    timeout_seconds: 180
    description: "Context Engineering Phase 2.2 Advanced Analytics Engine must provide reliable predictive intelligence with >85% framework accuracy and <2s response time"
    failure_impact: "Predictive intelligence unavailable, framework recommendations unreliable, initiative health scoring broken"
    business_impact: "Strategic decision support degraded, proactive risk detection lost, analytics-driven insights unavailable"
    introduced_version: "v2.4.0"
    owner: "martin"

  - name: "Organizational Learning P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_organizational_learning_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Context Engineering Phase 3.1 Organizational Learning Engine must provide organizational intelligence with <3s response time and 80%+ change prediction accuracy"
    failure_impact: "Organizational context lost, change prediction broken, cultural analysis unavailable"
    business_impact: "Organizational transformation guidance compromised, change management intelligence lost, cultural adaptation intelligence unavailable"
    introduced_version: "v3.0.0"
    owner: "martin"

  - name: "Team Dynamics P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_team_dynamics_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Context Engineering Phase 3.2 Team Dynamics Engine must provide cross-team coordination with 75%+ bottleneck detection accuracy and <3s response time"
    failure_impact: "Cross-team coordination fails, team collaboration optimization broken, dependency tracking unavailable"
    business_impact: "Multi-team delivery predictability compromised, coordination overhead increases, platform velocity degraded"
    introduced_version: "v2.9.0"
    owner: "martin"

  - name: "Real-Time Monitoring P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_realtime_monitoring_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Context Engineering Phase 3.2B Real-Time Monitoring must provide 5-minute detection latency, 90%+ alert accuracy with <5% false positive rate"
    failure_impact: "Real-time coordination issue detection fails, proactive alert system broken, event processing unreliable"
    business_impact: "Coordination downtime increases by 60%, team bottlenecks go undetected, reactive instead of proactive management"
    introduced_version: "v2.10.0"
    owner: "martin"

  - name: "ML Pattern Detection P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_ml_pattern_detection_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Context Engineering Phase 3.2B ML Pattern Detection must provide 85%+ collaboration success prediction accuracy with <5s response time"
    failure_impact: "ML-enhanced pattern detection fails, collaboration prediction broken, feature extraction unreliable"
    business_impact: "Predictive team management capability lost, 1-week advance warning system broken, pattern-based optimization unavailable"
    introduced_version: "v2.11.0"
    owner: "martin"

  - name: "CollaborationScorer P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_collaboration_scorer_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Context Engineering Phase 3.2B Epic 2 Completion - CollaborationScorer with ensemble ML models must provide 85%+ accuracy and <5s response time"
    failure_impact: "Ensemble ML collaboration scoring fails, advanced risk assessment broken, production-ready predictions unavailable"
    business_impact: "Strategic team management predictions become unreliable, risk assessment guidance lost, 1-week advance warning capability compromised"
    introduced_version: "v2.12.0"
    owner: "martin"

  - name: "Complete New Setup P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_complete_new_setup_p0_optimized.py"
    critical_level: "BLOCKING"
    timeout_seconds: 120
    description: "Complete new user setup journey from fresh git clone to working ClaudeDirector must be reliable and performant (optimized for CI)"
    failure_impact: "New users cannot successfully install ClaudeDirector, first touchpoint fails, setup abandonment"
    business_impact: "Zero new user acquisition, setup friction eliminates adoption, product discovery fails at first step"
    introduced_version: "v2.13.0"
    owner: "martin"

  # PHASE 7 STRATEGIC AI DEVELOPMENT - MODULAR AI INTELLIGENCE
  - name: "Predictive Analytics Engine P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_predictive_analytics_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 180
    description: "Phase 7 Modular Predictive Analytics Engine must provide >90% accurate strategic challenge predictions with <500ms response times"
    failure_impact: "Strategic intelligence becomes reactive instead of proactive, executives lose early warning capabilities"
    business_impact: "Competitive disadvantage, missed strategic interventions, reduced strategic decision quality"
    introduced_version: "v3.2.0"
    owner: "martin"

  - name: "Context-Aware Intelligence P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_context_aware_intelligence_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 180
    description: "Phase 7 Modular Context-Aware Intelligence must provide >95% context relevance accuracy with <200ms framework selection response times"
    failure_impact: "Strategic intelligence loses situational awareness, becomes generic instead of contextually optimized"
    business_impact: "Reduced strategic guidance effectiveness, suboptimal framework selection, competitive disadvantage"
    introduced_version: "v3.2.0"
    owner: "martin"

  - name: "Phase 8 Performance Optimization P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_phase8_performance_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Phase 8 performance optimization must achieve <500ms response times and <50MB memory usage for enterprise-grade performance"
    failure_impact: "System performance degrades below enterprise thresholds, user experience suffers significantly"
    business_impact: "Executive frustration with slow responses, system abandonment risk, competitive disadvantage"
    introduced_version: "v3.3.0"
    owner: "martin"

  - name: "Enhanced Predictive Intelligence P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_enhanced_predictive_intelligence_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 300
    description: "Phase 11 predictive intelligence must achieve 85%+ accuracy for strategic decisions with <500ms response time"
    failure_impact: "Strategic decision prediction fails, P1 business value (2.5x ROI) compromised"
    business_impact: "Predictive strategic guidance becomes unreliable, executive decision support compromised, competitive disadvantage"
    introduced_version: "v3.4.0"
    owner: "martin"

  - name: "Persona Challenge P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_persona_challenge_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 180
    description: "Persona challenge framework must provide 80%+ challenge detection accuracy and maintain persona authenticity"
    failure_impact: "Strategic personas become overly agreeable, lose strategic value"
    business_impact: "Strategic guidance becomes shallow, executive decision support compromised"
    introduced_version: "v3.4.0"
    owner: "martin"

  # P0 CRITICAL FEATURES: Sequential Thinking + Context7 Utilization
  - name: "Sequential Thinking Methodology P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_sequential_thinking_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 60
    description: "Sequential Thinking methodology must be applied to ALL development and analysis activities"
    failure_impact: "Development becomes ad-hoc, loses systematic approach, technical debt increases"
    business_impact: "Engineering productivity degrades, solution quality decreases, strategic value compromised"
    introduced_version: "v3.7.0"
    owner: "martin"

  - name: "Context7 MCP Utilization P0"
    test_module: ".claudedirector/tests/regression/p0_blocking/test_context7_utilization_p0.py"
    critical_level: "BLOCKING"
    timeout_seconds: 90
    description: "Context7 MCP server must be utilized for all strategic framework applications and architectural patterns"
    failure_impact: "Strategic frameworks lose Context7 intelligence, architectural patterns become generic"
    business_impact: "Strategic guidance quality degrades, loses context-aware intelligence capabilities"
    introduced_version: "v3.7.0"
    owner: "martin"


# Enforcement settings
enforcement:
  run_on_commit: true
  run_on_push: true
  run_on_pr: true
  save_results: true
  generate_reports: true
  audit_trail: true

# Notification settings
notifications:
  on_failure: true
  on_success: false
  include_business_impact: true
  include_remediation_steps: true

# Quality gates
quality_gates:
  minimum_pass_rate: 1.0  # 100% for BLOCKING tests
  maximum_duration_seconds: 300  # 5 minutes total
  retry_failed_tests: false  # No retries - immediate feedback
  fail_fast: true  # Stop on first BLOCKING failure

# Reporting
reporting:
  include_duration: true
  include_coverage: false
  include_performance: true
  save_to_file: true
  format: "json"
  retention_days: 30
